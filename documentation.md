# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ icandoit-1

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#–æ–±–∑–æ—Ä-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
2. [–°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π](#—Å–∏—Å—Ç–µ–º–∞-–∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π)
3. [–°–∏—Å—Ç–µ–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤](#—Å–∏—Å—Ç–µ–º–∞-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
4. [–°–∏—Å—Ç–µ–º–∞ —Å–∏–ª](#—Å–∏—Å—Ç–µ–º–∞-—Å–∏–ª)
5. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º)
6. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

---

## –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å —Ç—Ä–µ–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏:

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤
```
World/
‚îú‚îÄ‚îÄ Characters/        # –£–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏ (–∏–≥—Ä–æ–∫)
‚îú‚îÄ‚îÄ Objects/          
‚îÇ   ‚îú‚îÄ‚îÄ Components/   # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ Moving/       # –§–∏–∑–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã (–±–æ—á–∫–∏ –∏ —Ç.–¥.)
‚îú‚îÄ‚îÄ Spells/           # –°–Ω–∞—Ä—è–¥—ã –∏ —Ö–µ–ª–ø–µ—Ä—ã –¥–ª—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
‚îî‚îÄ‚îÄ Effects/          # –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (–≤–∑—Ä—ã–≤—ã)

Data/
‚îî‚îÄ‚îÄ Systems/          # –†–µ—Å—É—Ä—Å—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
```

---

## –°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π

–°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω–æ–º –ø–∞—Ç—Ç–µ—Ä–Ω–µ –ø–æ–≤–µ–¥–µ–Ω–∏–π. –ö–∞–∂–¥–æ–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ (`Spell`) —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ (`SpellBehavior`) –∫–æ—Ç–æ—Ä–æ–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫ –æ–Ω–æ –∫–∞—Å—Ç—É–µ—Ç—Å—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã

#### `Spell` (Data/Systems/Spell.gd)
–ì–ª–∞–≤–Ω—ã–π —Ä–µ—Å—É—Ä—Å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è.

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è:**
- `name: String` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è
- `cooldown: float` - –≤—Ä–µ–º—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- `cast_time: float` - –≤—Ä–µ–º—è –∫–∞—Å—Ç–∞
- `can_affect_caster: bool` - –º–æ–∂–µ—Ç –ª–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—å –∫–∞—Å—Ç–µ—Ä–∞
- `behavior: SpellBehavior` - –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞—Å—Ç–∞ (–≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –æ–¥–∏–Ω –∏–∑ —Ç–∏–ø–æ–≤)
- `on_hit: SpellEventConfig` - —Å–æ–±—ã—Ç–∏–µ –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏
- `on_bounce: SpellEventConfig` - —Å–æ–±—ã—Ç–∏–µ –ø—Ä–∏ –æ—Ç—Å–∫–æ–∫–µ
- `on_expire: SpellEventConfig` - —Å–æ–±—ã—Ç–∏–µ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏
- `on_tick: SpellEventConfig` - –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ
- `tick_interval: float` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Ç–∏–∫–∞–º–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `cast(caster: Node2D, target_position: Vector2, original_caster_override: Node2D = null)` - –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ

#### `SpellBehavior` (Data/Systems/SpellBehavior.gd)
–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –ø–æ–≤–µ–¥–µ–Ω–∏–π –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π. –ò–º–µ–µ—Ç 4 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

### 1. ProjectileConfig (—Å–Ω–∞—Ä—è–¥)

**–û—Å–Ω–æ–≤–Ω–æ–µ:**
–°–æ–∑–¥–∞—ë—Ç –ª–µ—Ç—è—â–∏–µ —Å–Ω–∞—Ä—è–¥—ã –∫–æ—Ç–æ—Ä—ã–µ –¥–≤–∏–≥–∞—é—Ç—Å—è –ø–æ –ø—Ä—è–º–æ–π –ª–∏–Ω–∏–∏, –º–æ–≥—É—Ç –æ—Ç—Å–∫–∞–∫–∏–≤–∞—Ç—å –∏ –ø—Ä–æ–±–∏–≤–∞—Ç—å —Ü–µ–ª–∏.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- `speed: float` - —Å–∫–æ—Ä–æ—Å—Ç—å —Å–Ω–∞—Ä—è–¥–∞
- `lifetime: float` - –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- `pierce: bool` - –ø—Ä–æ–±–∏–≤–∞–µ—Ç –ª–∏ —Ü–µ–ª–∏
- `can_affect_caster: bool` - –º–æ–∂–µ—Ç –ª–∏ –∑–∞–¥–µ—Ç—å –∫–∞—Å—Ç–µ—Ä–∞
- `affected_by_forces: bool` - –ø–æ–¥–≤–µ—Ä–∂–µ–Ω –ª–∏ —Å–∏–ª–∞–º
- `force_influence: float` - –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ —Å–∏–ª—ã –≤–ª–∏—è—é—Ç –Ω–∞ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é (0-1)

**–ê–Ω–∏–º–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏:**
- `animate_speed: bool` - –∞–Ω–∏–º–∏—Ä–æ–≤–∞—Ç—å –ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å
- `target_speed: float` - —Ü–µ–ª–µ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
- `speed_transition_duration: float` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∞
- `speed_trans_type / speed_ease_type` - —Ç–∏–ø –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏

**–û—Ç—Å–∫–æ–∫–∏:**
- `can_bounce: bool` - –º–æ–∂–µ—Ç –ª–∏ –æ—Ç—Å–∫–∞–∫–∏–≤–∞—Ç—å
- `max_bounces: int` - –º–∞–∫—Å–∏–º—É–º –æ—Ç—Å–∫–æ–∫–æ–≤ (0 = –Ω–µ—Ç, -1 = –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ)
- `bounce_from_bodies: bool` - –æ—Ç—Å–∫–∞–∫–∏–≤–∞–µ—Ç –ª–∏ –æ—Ç —Ç–µ–ª
- `bounce_from_projectiles: bool` - –æ—Ç—Å–∫–∞–∫–∏–≤–∞–µ—Ç –ª–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö —Å–Ω–∞—Ä—è–¥–æ–≤
- `bounce_speed_multiplier: float` - –º–Ω–æ–∂–∏—Ç–µ–ª—å —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –æ—Ç—Å–∫–æ–∫–∞

**–ú—É–ª—å—Ç–∏–∫–∞—Å—Ç:**
- `projectile_count: int` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–Ω–∞—Ä—è–¥–æ–≤
- `omnidirectional: bool` - –≤–æ –≤—Å–µ —Å—Ç–æ—Ä–æ–Ω—ã (360¬∞)
- `spread_angle: float` - —É–≥–æ–ª —Ä–∞–∑–±—Ä–æ—Å–∞ (–µ—Å–ª–∏ –Ω–µ omnidirectional)
- `instant_cast: bool` - –≤—Å–µ —Å–Ω–∞—Ä—è–¥—ã –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∏–ª–∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
- `cast_duration: float` - –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö —Å–Ω–∞—Ä—è–¥–æ–≤ (–µ—Å–ª–∏ sequential)
- `clockwise: bool` - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–∞—â–µ–Ω–∏—è –¥–ª—è omnidirectional

### 2. RaycastConfig (–ª—É—á)

**–û—Å–Ω–æ–≤–Ω–æ–µ:**
–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–æ–ø–∞–¥–∞–Ω–∏–µ –ª—É—á–æ–º –∏–∑ —Ç–æ—á–∫–∏ –∫–∞—Å—Ç–∞ –≤ —Ü–µ–ª–µ–≤—É—é —Ç–æ—á–∫—É.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- `max_range: float` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∞–ª—å–Ω–æ—Å—Ç—å
- `collision_mask: int` - –º–∞—Å–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π
- `pierce: bool` - –ø—Ä–æ–±–∏–≤–∞–µ—Ç –ª–∏ —Ü–µ–ª–∏
- `pierce_count: int` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–∏—Ç–∏–π (0 = –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –µ—Å–ª–∏ pierce=true)

### 3. AreaConfig (–æ–±–ª–∞—Å—Ç—å)

**–û—Å–Ω–æ–≤–Ω–æ–µ:**
–°–æ–∑–¥–∞—ë—Ç –æ–±–ª–∞—Å—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∞ –≤ —Ü–µ–ª–µ–≤–æ–π —Ç–æ—á–∫–µ (–≤–∑—Ä—ã–≤).

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- `area_scene_path: String` - –ø—É—Ç—å –∫ —Å—Ü–µ–Ω–µ –æ–±–ª–∞—Å—Ç–∏ (explosion.tscn)
- `radius: float` - —Ä–∞–¥–∏—É—Å –æ–±–ª–∞—Å—Ç–∏
- `max_force: float` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏—è
- `lifetime: float` - –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –æ–±–ª–∞—Å—Ç–∏ (0 = –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, >0 = –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∑–æ–Ω–∞)
- `can_affect_caster: bool` - –º–æ–∂–µ—Ç –ª–∏ –∑–∞–¥–µ—Ç—å –∫–∞—Å—Ç–µ—Ä–∞
- `falloff_exponent: float` - —Å–∫–æ—Ä–æ—Å—Ç—å —Å–ø–∞–¥–∞ —É—Ä–æ–Ω–∞/—Å–∏–ª—ã —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º (1.0 = –ª–∏–Ω–µ–π–Ω—ã–π, 2.0 = –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π)

### 4. InstantBehavior (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ)

**–û—Å–Ω–æ–≤–Ω–æ–µ:**
–ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç—ã –≤ —Ü–µ–ª–µ–≤–æ–π —Ç–æ—á–∫–µ –±–µ–∑ –≤–∏–∑—É–∞–ª–∞ —Å–Ω–∞—Ä—è–¥–∞.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ö–∏–ª–æ–≤, –±–∞—Ñ—Ñ–æ–≤, —Ç–µ–ª–µ–ø–æ—Ä—Ç–æ–≤.

---

### SpellEventConfig

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è. –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ `on_hit`, `on_bounce`, `on_expire`, `on_tick`.

**–ü–æ–ª—è:**
- `apply_damage: bool` - –Ω–∞–Ω–æ—Å–∏—Ç—å –ª–∏ —É—Ä–æ–Ω
- `damage_amount: float` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–Ω–∞
- `apply_force: bool` - –ø—Ä–∏–º–µ–Ω—è—Ç—å –ª–∏ —Å–∏–ª—É
- `force_magnitude: float` - –≤–µ–ª–∏—á–∏–Ω–∞ —Å–∏–ª—ã
- `force_duration: float` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—è —Å–∏–ª—ã
- `nested_spells: Array[Spell]` - –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è (–∫–∞—Å—Ç—É—é—Ç—Å—è –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è)

**–í–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è:**
–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—É—é –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å. –ù–∞–ø—Ä–∏–º–µ—Ä:
- –°–Ω–∞—Ä—è–¥ (Projectile) ‚Üí –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ (on_hit) ‚Üí –≤–∑—Ä—ã–≤ (Area) ‚Üí –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ (on_hit) ‚Üí –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–Ω–∞—Ä—è–¥–æ–≤

**–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–µ—Ä–∞:**
–í—Å—è —Ü–µ–ø–æ—á–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –ø–æ–º–Ω–∏—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–∞—Å—Ç–µ—Ä–∞ (`original_caster`). –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è:
- –ü—Ä–æ–≤–µ—Ä–∫–∏ `can_affect_caster` –Ω–∞ –ª—é–±–æ–º —É—Ä–æ–≤–Ω–µ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è —É—Ä–æ–Ω–∞/—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

---

## –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### EntityComponent (World/Objects/Components/EntityComponent.gd)

–ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤—Å–µ—Ö –∂–∏–≤—ã—Ö —Å—É—â–µ—Å—Ç–≤ (–∏–≥—Ä–æ–∫, –≤—Ä–∞–≥–∏, NPC).

**–°—Ç–∞—Ç—ã:**
- `max_health: float` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ
- `health_regen_per_sec: float` - —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤ —Å–µ–∫—É–Ω–¥—É
- `movement_speed: float` - —Å–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è
- `mass: float` - –º–∞—Å—Å–∞ (–≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–æ–ª—á–∫–∏)
- `push_power: float` - —Å–∏–ª–∞ —Ç–æ–ª—á–∫–∞ –¥—Ä—É–≥–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤

**–ú–µ—Ç–æ–¥—ã:**
- `apply_damage(amount: float)` - –Ω–∞–Ω–µ—Å—Ç–∏ —É—Ä–æ–Ω
- `heal(amount: float)` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ
- `is_alive() -> bool` - –∂–∏–≤ –ª–∏ –æ–±—ä–µ–∫—Ç
- `add_force(force: Force)` - –¥–æ–±–∞–≤–∏—Ç—å —Å–∏–ª—É (–æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ, –ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ)
- `compute_velocity(target_position, has_target, delta) -> Vector2` - –≤—ã—á–∏—Å–ª–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è —Å —É—á—ë—Ç–æ–º —Å–∏–ª
- `apply_push(push_force, pusher_mass, push_duration)` - –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ–ª—á–æ–∫
- `calculate_push_to(other, collision_normal, my_velocity) -> Dictionary` - —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ç–æ–ª—á–æ–∫ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
- `calculate_counter_push(other, collision_normal, other_velocity) -> Dictionary` - —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ—Ç–≤–µ—Ç–Ω—ã–π —Ç–æ–ª—á–æ–∫

**–°–∏–≥–Ω–∞–ª—ã:**
- `health_changed(current: float, max: float)` - –∑–¥–æ—Ä–æ–≤—å–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- `died()` - –æ–±—ä–µ–∫—Ç —É–º–µ—Ä

**–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥:**
- `EntityComponent.get_from(node: Node) -> EntityComponent` - –Ω–∞–π—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ —É–∑–ª–µ –∏–ª–∏ –µ–≥–æ –¥–µ—Ç—è—Ö

### EntityUIComponent (World/Objects/Components/UI/EntityUIComponent.gd)

UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —Å—É—â–Ω–æ—Å—Ç–∏.

**–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:**
- –ü–æ–ª–æ—Å–∫—É –∑–¥–æ—Ä–æ–≤—å—è (health bar)
- –ü–æ–ª–æ—Å–∫—É –∫–∞—Å—Ç–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è (cast bar)
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö —Å–∏–ª (debug)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- `show_health_bar / health_bar_offset / health_bar_size / health_bar_color`
- `show_cast_bar / cast_bar_offset / cast_bar_size / cast_bar_color`
- `show_force_debug / show_individual_forces / show_sum_forces`

**–ú–µ—Ç–æ–¥—ã:**
- `start_cast(duration: float)` - –Ω–∞—á–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Å—Ç–∞
- `cancel_cast()` - –æ—Ç–º–µ–Ω–∏—Ç—å –∫–∞—Å—Ç

### ForceReceiver (World/Spells/Helpers/ForceReceiver.gd)

–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å —Å–∏–ª—ã –Ω–æ –Ω–µ –∏–º–µ—é—Ç –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ EntityComponent (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ—Å—Ç—ã–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã).

**–ü–æ–ª—è:**
- `forces: Array[Force]` - –º–∞—Å—Å–∏–≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–∏–ª
- `mass: float` - –º–∞—Å—Å–∞ –æ–±—ä–µ–∫—Ç–∞

**–ú–µ—Ç–æ–¥—ã:**
- `add_force(force: Force)` - –¥–æ–±–∞–≤–∏—Ç—å —Å–∏–ª—É
- `get_forces_velocity() -> Vector2` - –ø–æ–ª—É—á–∏—Ç—å —Å—É–º–º–∞—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –≤—Å–µ—Ö —Å–∏–ª
- `clear_forces()` - –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–∏–ª—ã

---

## –°–∏—Å—Ç–µ–º–∞ —Å–∏–ª

### Force (Data/Systems/force.gd)

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–∏–ª—É –¥–µ–π—Å—Ç–≤—É—é—â—É—é –Ω–∞ –æ–±—ä–µ–∫—Ç (–æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ, –ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ, –≤–µ—Ç–µ—Ä).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞:**
```gdscript
Force.new(
    vector: Vector2,           # –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–ª—ã
    magnitude: float,          # –≤–µ–ª–∏—á–∏–Ω–∞
    base_duration: float,      # –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
    node: Node,               # —É–∑–µ–ª –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
    duration_coefficient: float = 0.0,  # –¥–æ–ø. –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É —Å–∏–ª—ã
    trans_type: Tween.TransitionType = TRANS_CUBIC,
    ease_type: Tween.EaseType = EASE_OUT
)
```

**–ú–µ—Ç–æ–¥—ã:**
- `get_current_force() -> Vector2` - —Ç–µ–∫—É—â–∞—è —Å–∏–ª–∞ —Å —É—á—ë—Ç–æ–º –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏
- `is_finished() -> bool` - –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –ª–∏ —Å–∏–ª–∞

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
–°–∏–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –∏—Å–ø–æ–ª—å–∑—É—è Tween. –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –ø–ª–∞–≤–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏—è/–ø—Ä–∏—Ç—è–∂–µ–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä:**
```gdscript
var force = Force.new(
    Vector2.RIGHT,      # –≤–ø—Ä–∞–≤–æ
    500.0,              # —Å–∏–ª–∞ 500
    0.5,                # –ø–æ–ª—Å–µ–∫—É–Ω–¥—ã
    target_node,
    0.0,
    Tween.TRANS_SINE,
    Tween.EASE_OUT
)
entity_component.add_force(force)
```

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º

### Player (World/Objects/Characters/player.gd)

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- **–ü–ö–ú (–∑–∞–∂–∞—Ç—å)** - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª–µ–≤—É—é —Ç–æ—á–∫—É –¥–≤–∏–∂–µ–Ω–∏—è (–º–∞—Ä–∫–µ—Ä —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∫—É—Ä—Å–æ—Ä–æ–º)
- **–ü–ö–ú (–æ—Ç–ø—É—Å—Ç–∏—Ç—å)** - –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ª–µ–≤—É—é —Ç–æ—á–∫—É
- **–¶–∏—Ñ—Ä—ã 1-0** - –∫–∞—Å—Ç–æ–≤–∞—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è –∏–∑ spell_book

**–ü–æ–ª—è:**
- `all_spells: ResourceGroup` - –≥—Ä—É–ø–ø–∞ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- `spell_book: Array` - –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è

**–î–≤–∏–∂–µ–Ω–∏–µ:**
–ü–µ—Ä—Å–æ–Ω–∞–∂ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `EntityComponent.compute_velocity()` –∫–æ—Ç–æ—Ä—ã–π:
1. –í—ã—á–∏—Å–ª—è–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫ —Ü–µ–ª–∏
2. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤—É—é—â–∏–µ —Å–∏–ª—ã
3. –°–º–µ—à–∏–≤–∞–µ—Ç —Ü–µ–ª–µ–≤—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –∏ —Å–∏–ª—ã –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å

**–ö–æ–ª–ª–∏–∑–∏–∏:**
–ü—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ `CharacterBody2D`:
1. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—á–æ–∫ —Å —É—á—ë—Ç–æ–º –º–∞—Å—Å –æ–±–æ–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤
2. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—á–æ–∫ –∫ —Ü–µ–ª–∏
3. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –æ—Ç–≤–µ—Ç–Ω—ã–π —Ç–æ–ª—á–æ–∫ (—Ç—Ä–µ—Ç–∏–π –∑–∞–∫–æ–Ω –ù—å—é—Ç–æ–Ω–∞)
4. –ü–µ—Ä—Å–æ–Ω–∞–∂ —Å–∫–æ–ª—å–∑–∏—Ç –≤–¥–æ–ª—å –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è

**–ö–∞—Å—Ç –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è:**
```gdscript
func _cast_spell(spell):
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –º—ã—à–∏
    # –ó–∞–¥–µ—Ä–∂–∫–∞ cast_time (–µ—Å–ª–∏ –µ—Å—Ç—å)
    # –ö–∞—Å—Ç –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ñ–∞–π—Ä–±–æ–ª–∞

1. –°–æ–∑–¥–∞–π —Ä–µ—Å—É—Ä—Å `Spell` –≤ –∏–Ω—Å–ø–µ–∫—Ç–æ—Ä–µ
2. –£—Å—Ç–∞–Ω–æ–≤–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
   - `name` = "Fireball"
   - `cooldown` = 1.0
   - `can_affect_caster` = false
3. –°–æ–∑–¥–∞–π `behavior` —Ç–∏–ø–∞ `ProjectileConfig`:
   - `speed` = 500
   - `lifetime` = 3.0
4. –°–æ–∑–¥–∞–π `on_hit` —Ç–∏–ø–∞ `SpellEventConfig`:
   - `apply_damage` = true
   - `damage_amount` = 25.0

### –ü—Ä–∏–º–µ—Ä 2: –í–∑—Ä—ã–≤–∞—é—â–∏–π—Å—è —Å–Ω–∞—Ä—è–¥

1. –°–æ–∑–¥–∞–π –æ—Å–Ω–æ–≤–Ω–æ–π Spell —Å ProjectileConfig
2. –í `on_hit` —Å–æ–∑–¥–∞–π `SpellEventConfig`
3. –í `nested_spells` –¥–æ–±–∞–≤—å –≤—Ç–æ—Ä–æ–π Spell —Å AreaConfig:
   - `radius` = 150
   - `lifetime` = 0 (–º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –≤–∑—Ä—ã–≤)
4. –í–æ –≤—Ç–æ—Ä–æ–º Spell –Ω–∞—Å—Ç—Ä–æ–π `on_hit` —Å —É—Ä–æ–Ω–æ–º

–†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–Ω–∞—Ä—è–¥ –ª–µ—Ç–∏—Ç ‚Üí –ø–æ–ø–∞–¥–∞–µ—Ç ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–±–ª–∞—Å—Ç—å ‚Üí –æ–±–ª–∞—Å—Ç—å –Ω–∞–Ω–æ—Å–∏—Ç —É—Ä–æ–Ω –≤—Å–µ–º –≤ —Ä–∞–¥–∏—É—Å–µ

### –ü—Ä–∏–º–µ—Ä 3: –ü—É–ª–µ–º—ë—Ç

1. –°–æ–∑–¥–∞–π Spell —Å ProjectileConfig
2. –£—Å—Ç–∞–Ω–æ–≤–∏:
   - `projectile_count` = 5
   - `spread_angle` = 15¬∞ (–Ω–µ–±–æ–ª—å—à–æ–π —Ä–∞–∑–±—Ä–æ—Å)
   - `instant_cast` = true
   - `cooldown` = 0.1

### –ü—Ä–∏–º–µ—Ä 4: –ö—Ä—É–≥–æ–≤–æ–π –≤–∑—Ä—ã–≤ —Å–Ω–∞—Ä—è–¥–æ–≤

1. –°–æ–∑–¥–∞–π Spell —Å AreaConfig –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –≤–∑—Ä—ã–≤–∞
2. –í `on_hit` –¥–æ–±–∞–≤—å nested Spell —Å ProjectileConfig:
   - `projectile_count` = 12
   - `omnidirectional` = true
   - `speed` = 300

### –ü—Ä–∏–º–µ—Ä 5: –¶–µ–ø–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è

```
Spell 1 (Projectile)
‚îî‚îÄ on_hit: SpellEventConfig
   ‚îî‚îÄ nested_spells: Spell 2 (Area)
      ‚îî‚îÄ on_hit: SpellEventConfig
         ‚îî‚îÄ nested_spells: Spell 3 (Projectile)
            ‚îî‚îÄ projectile_count = 3
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–Ω–∞—Ä—è–¥ ‚Üí –≤–∑—Ä—ã–≤ ‚Üí —Ç—Ä–∏ –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–Ω–∞—Ä—è–¥–∞ —Ä–∞–∑–ª–µ—Ç–∞—é—Ç—Å—è

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–µ—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–∞—Å—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ –≤—Å—é —Ü–µ–ø–æ—á–∫—É:

```
Player –∫–∞—Å—Ç—É–µ—Ç Spell 1
‚îú‚îÄ Projectile —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å original_caster = Player
‚îÇ  ‚îî‚îÄ on_hit —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚Üí nested Spell 2
‚îÇ     ‚îî‚îÄ Area —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å original_caster = Player
‚îÇ        ‚îî‚îÄ on_hit —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚Üí nested Spell 3
‚îÇ           ‚îî‚îÄ Projectile —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å original_caster = Player
```

–í—Å–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å–Ω–∞—Ä—è–¥—ã/–æ–±–ª–∞—Å—Ç–∏ –∑–Ω–∞—é—Ç –∫—Ç–æ –Ω–∞—Å—Ç–æ—è—â–∏–π –∏–≥—Ä–æ–∫ –∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç `can_affect_caster` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π —Å –∫–∞—Å—Ç–µ—Ä–æ–º

–í `Projectile._on_body_entered()`:
```gdscript
if not can_affect_caster and (body == caster or body == original_caster):
    return  # –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–æ–ª–ª–∏–∑–∏—é
```

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–∞–∫ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–æ–∑–¥–∞—Ç–µ–ª—å —Å–Ω–∞—Ä—è–¥–∞ (`caster`), —Ç–∞–∫ –∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∏–≥—Ä–æ–∫ (`original_caster`).

### Falloff —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –æ–±–ª–∞—Å—Ç–µ–π

`Explosion._apply_to_target()` –≤—ã—á–∏—Å–ª—è–µ—Ç:
1. –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –¥–æ —Ü–µ–ª–∏
2. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (—Å —É—á—ë—Ç–æ–º —Ä–∞–¥–∏—É—Å–∞ –∫–æ–ª–ª–∏–∑–∏–∏ —Ü–µ–ª–∏)
3. Falloff = (1 - distance/radius) ^ falloff_exponent
4. –£—Ä–æ–Ω/—Å–∏–ª–∞ —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ falloff

–≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Å–ø–∞–¥ —ç—Ñ—Ñ–µ–∫—Ç–∞ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –≤–∑—Ä—ã–≤–∞.

### –§–∏–∑–∏–∫–∞ —Ç–æ–ª—á–∫–æ–≤

–ü—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏ –¥–≤—É—Ö –æ–±—ä–µ–∫—Ç–æ–≤:

```gdscript
push_ratio = my_mass / (my_mass + other_mass)
push_force = collision_normal * velocity_into_normal * push_ratio * push_power
```

–ß–µ–º —Ç—è–∂–µ–ª–µ–µ –æ–±—ä–µ–∫—Ç, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ –æ–Ω —Ç–æ–ª–∫–∞–µ—Ç –¥—Ä—É–≥–∏—Ö –∏ —Ç–µ–º –º–µ–Ω—å—à–µ –µ–≥–æ —Ç–æ–ª–∫–∞—é—Ç.

---

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è

1. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π —Ñ–∞–π–ª –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π `SpellBehavior`
2. –†–µ–∞–ª–∏–∑—É–π –º–µ—Ç–æ–¥:
```gdscript
func cast(spell, caster: Node2D, target_position: Vector2, original_caster: Node2D = null) -> void:
    # —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞
```
3. –ò—Å–ø–æ–ª—å–∑—É–π `spell._trigger_event()` –¥–ª—è –≤—ã–∑–æ–≤–∞ —Å–æ–±—ã—Ç–∏–π
4. –ü–µ—Ä–µ–¥–∞–≤–∞–π `original_caster` –≤–æ –≤—Å–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–∞—Å—Ç—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ Spell (–Ω–∞–ø—Ä–∏–º–µ—Ä `on_critical`, `on_reflect`):
1. –î–æ–±–∞–≤—å –ø–æ–ª–µ `@export var on_critical: SpellEventConfig`
2. –í –Ω—É–∂–Ω–æ–º –º–µ—Å—Ç–µ –≤—ã–∑–æ–≤–∏ `spell._trigger_event(spell.on_critical, ...)`

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

–î–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (—è–¥, –∑–∞–º–æ—Ä–æ–∑–∫–∞):
1. –†–∞—Å—à–∏—Ä—å `SpellEventConfig` –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏
2. –û–±—Ä–∞–±–æ—Ç–∞–π –∏—Ö –≤ `Spell._trigger_event()`
3. –ò–ª–∏ —Å–æ–∑–¥–∞–π –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Å—Ç–∞—Ç—É—Å-—ç—Ñ—Ñ–µ–∫—Ç–æ–≤

---

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –°–Ω–∞—Ä—è–¥ –Ω–µ –Ω–∞–Ω–æ—Å–∏—Ç —É—Ä–æ–Ω –∫–∞—Å—Ç–µ—Ä—É –¥–∞–∂–µ —Å can_affect_caster=true

–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ **–î–í–ê** —Ñ–ª–∞–≥–∞:
- `Spell.can_affect_caster = true`
- `ProjectileConfig.can_affect_caster = true`

### Nested spells –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç

–£–±–µ–¥–∏—Å—å —á—Ç–æ:
1. `SpellEventConfig` –Ω–µ null
2. –ú–∞—Å—Å–∏–≤ `nested_spells` –Ω–µ –ø—É—Å—Ç–æ–π
3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Å–æ–±—ã—Ç–∏–µ –≤–æ–æ–±—â–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä `on_hit` —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è)

### Tick events –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

–ü—Ä–æ–≤–µ—Ä—å:
1. `spell.on_tick` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
2. `spell.tick_interval > 0`
3. Projectile –∂–∏–≤—ë—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ (`lifetime` –±–æ–ª—å—à–µ `tick_interval`)

### Circular dependency error –ø—Ä–∏ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏

–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π —è–≤–Ω—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é `Spell` –≤:
- `SpellBehavior` –∏ –µ–≥–æ –ø–æ—Ç–æ–º–∫–∞—Ö
- `SpellEventConfig`
- `Projectile` –∏ `Explosion`

–ò—Å–ø–æ–ª—å–∑—É–π –Ω–µ—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–ª–∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ —Ö–∏–Ω—Ç—ã:
```gdscript
var spell  # –≤–º–µ—Å—Ç–æ spell: Spell
@export_custom(PROPERTY_HINT_ARRAY_TYPE, "Spell") var nested_spells: Array = []
```

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –°–Ω–∞—Ä—è–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `queue_free()` –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ lifetime
- –°–∏–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –∫–æ–≥–¥–∞ `is_finished() == true`
- –ò—Å–ø–æ–ª—å–∑—É–π `instant_cast=false` –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–Ω–∞—Ä—è–¥–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π `projectile_count` (–¥–æ 20-30 –Ω–∞ –∫–∞—Å—Ç)
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π –≥–ª—É–±–∏–Ω—É –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π (3-4 —É—Ä–æ–≤–Ω—è –º–∞–∫—Å–∏–º—É–º)
- –ò—Å–ø–æ–ª—å–∑—É–π `lifetime` –¥–ª—è —Å–Ω–∞—Ä—è–¥–æ–≤ —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –ª–µ—Ç–∞–ª–∏ –≤–µ—á–Ω–æ
- –î–ª—è —á–∞—Å—Ç—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π object pooling (–≤–Ω–µ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –º–æ–¥—É–ª—å–Ω–∞—è –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è. –ö–æ–º–±–∏–Ω–∏—Ä—É—è 4 —Ç–∏–ø–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–π, —Å–æ–±—ã—Ç–∏—è –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ª—é–±–æ–π —ç—Ñ—Ñ–µ–∫—Ç –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ —Ñ–∞–π—Ä–±–æ–ª–∞ –¥–æ —Å–ª–æ–∂–Ω—ã—Ö —Ü–µ–ø–Ω—ã—Ö —Ä–µ–∞–∫—Ü–∏–π.

–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ –ü–æ–ª–∏–º–æ—Ä—Ñ–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–æ–¥–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –º–Ω–æ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π)
- ‚úÖ –ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–µ—Ä–∞
- ‚úÖ –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –§–∏–∑–∏–∫–∞ –º–∞—Å—Å –∏ —Å–∏–ª
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —á–µ—Ä–µ–∑ —Ä–µ—Å—É—Ä—Å—ã (–±–µ–∑ –∫–æ–¥–∞)

–£–¥–∞—á–∏ –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π! üî•‚ö°üßô‚Äç‚ôÇÔ∏è

## P.S.

–î–æ–∫–∏ —Å–≥–µ–Ω–µ—Ä–µ–Ω—ã –≥–∏—Ç—Ö–∞–± –∫–æ–ø–∏–ª–æ—Ç–æ–º —Å –º–æ–¥–µ–ª—å—é –∫–ª–æ–¥ —Å–æ–Ω–Ω–µ—Ç 4.5, —Ö–æ—Å–ø–∞–¥–µ, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∞–º–∞ –ø–∏—à–µ—Ç—Å—è!!! –º–µ—á—Ç–∞